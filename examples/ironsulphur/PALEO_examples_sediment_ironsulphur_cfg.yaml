

########################################################
# Boudreau (1996) test cases with Corg, O2, SO4/H2S, P, Fe, no Fe-S or pyrite
# Three columns: shelf/slope,  rise, rise (no bioturbation)
# NB: no N, so results differ in detail from the paper.
##############################################################
sediment_Corg_O2_Fe:
    parameters:
        CIsotope: ScalarData
        SIsotope: ScalarData
    domains:
        global:
            # scalar domain
     
        fluxOceanfloor:
            reactions:
                floorstubparticulateflux:
                    class: ReactionFluxTarget
                    parameters:
                        const_stub: true
                        target_prefix: particulateflux_
                        fluxlist: ["Corg1", "Corg2", "FeHR", "FeMR", "FePR"]
                    
                    variable_attributes:
                        #                                   Boudreau (1996) test cases
                        #                                   Shelf/slope Rise    Rise
                        #                                 
                        #                                    130    18.5        18.5  umol/cm^2/y  
                        particulateflux_Corg1:initial_value: [130e-2, 0.0,      0.0]  # mol yr-1 = umol/cm^2/y * 1e-6 * area m^2 * 1e4
                        particulateflux_Corg2:initial_value: [0.0,    18.5e-2,   18.5e-2]  # mol yr-1 = umol/cm^2/y * 1e-6 * area m^2 * 1e4
                        #                                     1000   100         100  FeT umol/m^2/d, 1/6 to each of FeHR, FeMR, FePR
                        particulateflux_FeHR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                        particulateflux_FeMR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                        particulateflux_FePR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                                        

                transfersolute:
                    class: ReactionFluxTarget
                    parameters:
                        target_prefix: soluteflux_
                        fluxlist: ["O2", "P", "SO4", "H2S", "CH4", "FeII"]
                   

        fluxOceanBurial:       
            reactions:
                transfer:
                    class: ReactionFluxTarget
                    parameters:
                        target_prefix: flux_
                        fluxlist: ["Corg1", "Corg2", "FeHR", "FeMR", "FePR"]
                    variable_links:
                        
 
        oceanfloor:

            reactions:
                grid:
                    class: ReactionUnstructuredVectorGrid
                    parameters:
                        ncells: 3
                
                floorstubphys: 
                    class: ReactionConst
                    parameters:
                        constnames: ["Afloor", "zfloor", "temp", "sal", "phi", "w_accum", "zbio", "Dbio", "alpha"]
                    variable_attributes:
                        #                       Boudreau (1996) test cases
                        #                       Shelf/slope Rise    Rise
                        Afloor:initial_value:   1.0                               # m^2
                        zfloor:initial_value:   [-100.0, -1000.0,        -1000.0] # m
                        temp:initial_value:     [278.15,    275.15,     275.15]  # K
                        sal:initial_value:      35.0 # psu
                        phi:initial_value:      0.8
                        w_accum:initial_value:  [0.03e-2,   0.003e-2,   0.003e-2]  # m yr-1
                        zbio:initial_value:     0.1  # m, 10 cm bioturbation depth
                        Dbio:initial_value:     [1.35e-4,   0.269e-4,  0.0] # m^2 yr-1
                        alpha:initial_value:    0.0     # yr-1

                        # TODO - need to set norm_value so cell volume is reasonable for state var norms
                        Afloor:norm_value:   1.0                               # m^2
                        phi:norm_value:      0.8

                floorstubsoluteconc: 
                    class: ReactionConst
                    parameters:
                        constnames: ["O2_conc", "P_conc", "SO4_conc", "H2S_conc", "CH4_conc", "FeII_conc"]
                    variable_attributes:
                        #                       Boudreau (1996) test cases
                        #                       Shelf/slope Rise        Rise
                        O2_conc:initial_value:   [0.250,    0.180,        0.180]  # mol m-3
                        SO4_conc:initial_value:   28756.0e-3   # concentration mol m-3 ~ 28e-3 mol/kg * 1027 kg m-3
                        H2S_conc:initial_value:   0.0  # mol m-3
                        CH4_conc:initial_value:   0.0  # mol m-3
                        FeII_conc:initial_value:   0.0  # mol m-3
                        P_conc:initial_value:    [0.001,    0.001,        0.001]  # mol m-3
                        

                transfer_particulatefluxOceanfloor:
                    class: ReactionFluxTransfer
                    parameters:
                        transfer_matrix:      Identity
                        input_fluxes:         fluxOceanfloor.particulateflux_$fluxname$
                        output_fluxes:        sediment.oceanfloor.$fluxname$_sms
                    variable_links:           

        ocean:  # dummy Domain to suppress error from fluxOceanfloor
            

        sediment:
            reactions:
                bioratesed:
                    class: ReactionSedimentBioRates

                transportsed:
                   class: ReactionSedimentTransport
                   parameters:
                        L:                              0.15  # 0.15m column
                        ncellspercol:                   100
                        f_grid:                         quadratic
                        grid_eta:                       0.075
                        zdbl:                           0.04e-2  # diffusive boundary layer at sediment-water interface
                       
                reservoir_O2:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             O2*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: O2

                reservoir_SO4:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             SO4*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   20000e-3                        
                        R_conc:diffusivity_speciesname: SO4

                reservoir_H2S:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             H2S*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                1e-30  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: H2S 

                reservoir_CH4:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             CH4*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: CH4

                reservoir_P:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             P*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   2e-3                        
                        R_conc:diffusivity_speciesname: PO4

                reservoir_FeII:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeII*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   2e-3                        
                        R_conc:diffusivity_speciesname: Fe

                reservoir_Corg1:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             Corg1*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   2083.3  # mol m-3 solid for 1% TOC  =  2.5  * (1 wt%/100) / 12 * 1e6

                reservoir_Corg2:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             Corg2*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   2083.3  # mol m-3 solid for 1% TOC  =  2.5  * (1 wt%/100) / 12 * 1e6

                reservoir_FeHR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeHR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid

                reservoir_FeMR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeMR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid

                reservoir_FePR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FePR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid
                                         
                pocdecay1:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     1.6393  # yr,  0.61 yr-1                      
                    variable_links:
                        Particle*:       Corg1*
                        decayflux:       POC_decay

                pocdecay2:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     100.0  # yr,  1e-2 yr-1
                    variable_links:
                        Particle*:       Corg2*
                        decayflux:       POC_decay

                pocdecaycomponents:
                    class: ReactionFluxToComponents
                    parameters: 
                        outputflux_prefix: remin_                   
                        outputflux_names: ["Corg", "N", "P"]
                        #                  106/106 16/106  1/106
                        outputflux_stoich: [1.0, 0.15094, 0.009434]   # must match input Corg stoich
                    variable_links:
                        inputflux:  POC_decay

                FeHRdecay:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     0.7  # yr, Dale (2015)
                    variable_links:
                        Particle*:       FeHR*
                        decayflux:       FeMR_sms

                   
                reminsed:
                    class: ReactionReminO2_Fe_SO4_CH4
                    # class: ReactionReminO2_SO4_CH4

                    parameters:
                        SO4reminlimit:  1000.0e-3
                        FeIIIOxreminlimit: 3.0 # (mol m-3) = 100e-6*3e6 100 umol Fe(OH)3 g-1 assuming dry density is 3 g/cm^3 (= 3e6 g m^-3)

                    variable_links:
                        FeIIIOx_conc:      FeHR_conc
                        soluteflux_*:   "*_sms"
                        soluteflux_FeIIIOx: FeHR_sms

                redox_H2S_O2:
                    class: ReactionRedoxH2S_O2

                    parameters:           
                        R_H2S_O2: 3e5 # Boudreau (1997)
                        # R_H2S_O2: 3.65e4 # 3.65e3 # (mol m-3) yr-1
                        # R_H2S_O2: 7e3 # slow > 1e6 iters rate for numerical efficiency (mol m-3) yr-1
                        # R_H2S_O2: 3.65e3 # fast reduce rate for numerical efficiency (mol m-3) yr-1
                        # R_H2S_O2: 1.8e3 # fast reduce rate for numerical efficiency (mol m-3) yr-1
                    variable_links:
                        volume:                         volume_solute

                redox_CH4_O2:
                    class: ReactionRedoxCH4_O2

                    parameters:                 
                        # R_CH4_O2: 1e4 # reduce rate for numerical stability 
                        R_CH4_O2: 1e7 # (mol m-3) yr-1 (1e10 mol/l yr-1) Boudreau (1997)

                    variable_links:
                        volume:                         volume_solute

                redox_CH4_SO4:
                    class: ReactionRedoxCH4_SO4

                    parameters:                 
                        R_CH4_SO4: 10.0 # (mol m-3) yr-1

                    variable_links:
                        volume:                         volume_solute

                redox_FeII_O2:
                    class: ReactionRedoxFeII_O2

                    parameters:                     
                        R_FeII_O2: 5e5 # (mol m-3)-1 yr-1,  5e8 M yr-1 = 5e8*1e-3 (mol m-3) yr-1, Dale (2015)

                    variable_links:
                        volume:                         volume_solute
                        FeIIIOx*: FeHR*


                redox_FeHR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 3.16 #  (mol m-3)^-0.5 yr-1, 100 M-0.5 yr-1        = 100*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:           volume_solid
                        redox_FeIII_H2S*: redox_FeHR_H2S*
                        FeIIIOx*: FeHR*

                redox_FeMR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 3.16e-3 #  (mol m-3)^-0.5 yr-1, 0.1 M-0.5 yr-1        = 0.1*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:           volume_solid
                        redox_FeIII_H2S*: redox_FeMR_H2S*
                        FeIIIOx*: FeMR*    

                redox_FePR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 9.48e-6 #  (mol m-3)^-0.5 yr-1, 0.1 M-0.5 yr-1        = 3e-4*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:           volume_solid
                        redox_FeIII_H2S*: redox_FePR_H2S*
                        FeIIIOx*: FePR*


        sedimentfloor:
            reactions:

        sedcrust: # dummy Domain to suppress error from fluxOceanBurial
            


########################################################
# Boudreau (1996) test cases with Corg, O2, SO4/H2S, P, Fe, with FeS system and pyrite
# Default config has three columns: shelf/slope,  rise, rise (no bioturbation)
# Set num_columns and per-column parameters to define a different ensemble.
# NB: no N, so results differ in detail from the paper.
##############################################################
sediment_Corg_O2_Fe_pyr:
    parameters:
        num_columns: 3
        CIsotope: ScalarData
        SIsotope: ScalarData
    domains:
        global:
            # scalar domain
     
        fluxOceanfloor:
            reactions:
                floorstubparticulateflux:
                    class: ReactionFluxTarget
                    parameters:
                        const_stub: true
                        target_prefix: particulateflux_
                        fluxlist: ["Corg1", "Corg2", "FeHR", "FeMR", "FePR", "FeSm", "FeS2pyr"]
                    
                    variable_attributes:
                        #                                   Boudreau (1996) test cases
                        #                                   Shelf/slope Rise    Rise
                        #                                 
                        #                                    130    18.5        18.5  umol/cm^2/y  
                        particulateflux_Corg1:initial_value: [130e-2, 0.0,      0.0]  # mol yr-1 = umol/cm^2/y * 1e-6 * area m^2 * 1e4
                        particulateflux_Corg2:initial_value: [0.0,    18.5e-2,   18.5e-2]  # mol yr-1 = umol/cm^2/y * 1e-6 * area m^2 * 1e4
                        #                                     1000   100         100  FeT umol/m^2/d, 1/6 to each of FeHR, FeMR, FePR
                        particulateflux_FeHR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                        particulateflux_FeMR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                        particulateflux_FePR:initial_value: [0.0608, 0.00608,   0.00608] # mol yr-1 = umol/m^2/d * 1e-6 * area m^2 * 365.25
                        particulateflux_FeSm:initial_value: 0.0
                        particulateflux_FeS2pyr:initial_value: 0.0

                transfersolute:
                    class: ReactionFluxTarget
                    parameters:
                        target_prefix: soluteflux_
                        fluxlist: ["O2", "P", "SO4", "SmIIaqtot", "CH4", "H2", "FeIIaqtot"]
                   

        fluxOceanBurial:       
            reactions:
                transfer:
                    class: ReactionFluxTarget
                    parameters:
                        target_prefix: flux_
                        fluxlist: ["Corg1", "Corg2", "FeHR", "FeMR", "FePR", "FeSm", "FeS2pyr"]
                    variable_links:
                        
 
        oceanfloor:

            reactions:
                grid:
                    class: ReactionUnstructuredVectorGrid
                    parameters:
                        ncells: external%num_columns
                
                floorstubphys: 
                    class: ReactionConst
                    parameters:
                        constnames: ["Afloor", "zfloor", "temp", "sal", "phi", "w_accum", "zbio", "Dbio", "alpha"]
                    variable_attributes:
                        #                       Boudreau (1996) test cases
                        #                       Shelf/slope Rise    Rise
                        Afloor:initial_value:   1.0                                # m^2
                        zfloor:initial_value:   [-100.0, -1000.0,        -1000.0] # m
                        temp:initial_value:     [278.15,    275.15,     275.15]  # K
                        sal:initial_value:      35.0 # psu
                        phi:initial_value:      0.8
                        w_accum:initial_value:  [0.03e-2,   0.003e-2,   0.003e-2]  # m yr-1
                        zbio:initial_value:     0.1  # m, 10 cm bioturbation depth
                        Dbio:initial_value:     [1.35e-4,   0.269e-4,  0.0] # m^2 yr-1
                        alpha:initial_value:    0.0     # yr-1

                        # TODO - need to set norm_value so cell volume is reasonable for state var norms
                        Afloor:norm_value:    1.0                                # m^2
                        phi:norm_value:      0.8

                floorstubsoluteconc: 
                    class: ReactionConst
                    parameters:
                        constnames: ["O2_conc", "P_conc", "SO4_conc", "SmIIaqtot_conc", "CH4_conc", "H2_conc", "FeIIaqtot_conc"]
                    variable_attributes:
                        #                       Boudreau (1996) test cases
                        #                       Shelf/slope Rise        Rise
                        O2_conc:initial_value:   [0.250,    0.180,        0.180]  # mol m-3
                        SO4_conc:initial_value:   28756.0e-3   # concentration mol m-3 ~ 28e-3 mol/kg * 1027 kg m-3
                        SmIIaqtot_conc:initial_value:   0.0  # mol m-3
                        CH4_conc:initial_value:   0.0  # mol m-3
                        H2_conc:initial_value:   0.0  # mol m-3
                        FeIIaqtot_conc:initial_value:   0.0  # mol m-3
                        P_conc:initial_value:   0.001  # mol m-3
                        

                transfer_particulatefluxOceanfloor:
                    class: ReactionFluxTransfer
                    parameters:
                        transfer_matrix:      Identity
                        input_fluxes:         fluxOceanfloor.particulateflux_$fluxname$
                        output_fluxes:        sediment.oceanfloor.$fluxname$_sms
                    variable_links:           

        ocean:  # dummy Domain to suppress error from fluxOceanfloor
            

        sediment:
            reactions:
                bioratesed:
                    class: ReactionSedimentBioRates

                transportsed:
                   class: ReactionSedimentTransport
                   parameters:
                        L:                              0.15  # 0.15m column
                        ncellspercol:                   100
                        f_grid:                         quadratic
                        grid_eta:                       0.075
                        zdbl:                           0.04e-2  # diffusive boundary layer at sediment-water interface
                       
                reservoir_Hp:
                    # H+ for constant pH 8
                    class: ReactionReservoirConst

                    variable_links:
                        R*: Hp* 
                    variable_attributes:
                        R_conc:initial_value: 1e-5   # mol m-3  10^-8.0 *1e3  [H+] at pH 8.0

                reservoir_O2:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             O2*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: O2

                reservoir_SO4:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             SO4*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   20000e-3                        
                        R_conc:diffusivity_speciesname: SO4

                reservoir_SmIIaqtot:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             SmIIaqtot*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                1e-30  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: H2S 

                reservoir_CH4:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             CH4*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   200e-3                        
                        R_conc:diffusivity_speciesname: CH4

                reservoir_H2:
                    class: ReactionReservoirTotal
                    parameters:
                       
                    variable_links:
                        R*: H2*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute          
                        R:initial_value:       1e-6   # concentration mol m-3 ~ 1e-9 mol/kg * 1027 kg m-3
                        # R:initial_delta:       0.0
                        R:norm_value:          1.0e-3 # for scaling only
                        R_conc:diffusivity_speciesname: H2

                reservoir_P:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             P*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   2e-3                        
                        R_conc:diffusivity_speciesname: PO4

                reservoir_FeIIaqtot:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeIIaqtot*
                        volume:                         volume_solute
                    variable_attributes:
                        R_conc:vphase:                  VP_Solute                    
                        R:initial_value:                0.0  # concentration m-3 (1027 kg m-3 * 200e-6 mol/kg-sw)
                        R:norm_value:                   2e-3                        
                        R_conc:diffusivity_speciesname: Fe

                reservoir_Corg1:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             Corg1*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   2083.3  # mol m-3 solid for 1% TOC  =  2.5  * (1 wt%/100) / 12 * 1e6

                reservoir_Corg2:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             Corg2*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   2083.3  # mol m-3 solid for 1% TOC  =  2.5  * (1 wt%/100) / 12 * 1e6

                reservoir_FeHR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeHR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid

                reservoir_FeMR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FeMR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid

                reservoir_FePR:
                    class: ReactionReservoirTotal            
                    variable_links:
                        R*:                             FePR*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                        
                        R:initial_value:                0.0  # concentration m-3 solid phase
                                                             #  mol m-3              =  g cm-3            / (g mol-1) * m^3 cm-3
                        R:norm_value:                   1.0  # mol m-3 solid

                reservoir_FeSm:
                    class: ReactionReservoirTotal
                    
                    variable_links:
                        R*: FeSm*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid                          
                        R:initial_value:       1e-9   # concentration mol m-3 ~ 1e-9 mol/kg * 1027 kg m-3                      
                        R:norm_value:          1.0e-3 # for scaling only                        

                reservoir_FeS2pyr:
                    class: ReactionReservoirTotal
                    
                    variable_links:
                        R*: FeS2pyr*
                        volume:                         volume_solid
                    variable_attributes:
                        R_conc:vphase:                  VP_Solid          
                        R:initial_value:       1e-30   # concentration mol m-3 ~ 1e-9 mol/kg * 1027 kg m-3                      
                        R:norm_value:          1.0e-3 # for scaling only

                pocdecay1:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     1.6393  # yr,  0.61 yr-1                      
                    variable_links:
                        Particle*:       Corg1*
                        decayflux:       POC_decay

                pocdecay2:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     100.0  # yr,  1e-2 yr-1
                    variable_links:
                        Particle*:       Corg2*
                        decayflux:       POC_decay

                pocdecaycomponents:
                    class: ReactionFluxToComponents
                    parameters: 
                        outputflux_prefix: remin_                   
                        outputflux_names: ["Corg", "N", "P"]
                        #                  106/106 16/106  1/106
                        outputflux_stoich: [1.0, 0.15094, 0.009434]   # must match input Corg stoich
                    variable_links:
                        inputflux:  POC_decay

                FeHRdecay:
                    class: ReactionParticleDecay
                    parameters:
                        decay_timescale:     0.7  # yr, Dale (2015)
                    variable_links:
                        Particle*:       FeHR*
                        decayflux:       FeMR_sms

                   
                reminsed:
                    class: ReactionReminO2_Fe_SO4_CH4
                    # class: ReactionReminO2_SO4_CH4

                    parameters:
                        SO4reminlimit:  1000.0e-3
                        FeIIIOxreminlimit: 3.0 # (mol m-3) = 100e-6*3e6 100 umol Fe(OH)3 g-1 assuming dry density is 3 g/cm^3 (= 3e6 g m^-3)

                    variable_links:
                        FeIIIOx_conc:      FeHR_conc
                        soluteflux_*:   "*_sms"
                        soluteflux_H2S: SmIIaqtot_sms
                        soluteflux_FeII:   FeIIaqtot_sms
                        soluteflux_FeIIIOx: FeHR_sms

                redox_H2S_O2:
                    class: ReactionRedoxH2S_O2

                    parameters:           
                        R_H2S_O2: 3e5 # Boudreau (1997)
                        # R_H2S_O2: 3.65e4 # 3.65e3 # (mol m-3) yr-1
                        # R_H2S_O2: 7e3 # slow > 1e6 iters rate for numerical efficiency (mol m-3) yr-1
                        # R_H2S_O2: 3.65e3 # fast reduce rate for numerical efficiency (mol m-3) yr-1
                        # R_H2S_O2: 1.8e3 # fast reduce rate for numerical efficiency (mol m-3) yr-1

                    variable_links:
                        volume:                         volume_solute
                        H2S_conc:  H2Stot_conc
                        H2S_sms: SmIIaqtot_sms

                redox_CH4_O2:
                    class: ReactionRedoxCH4_O2

                    parameters:                 
                        # R_CH4_O2: 1e4 # reduce rate for numerical stability 
                        R_CH4_O2: 1e7 # (mol m-3) yr-1 (1e10 mol/l yr-1) Boudreau (1997)
                    variable_links:
                        volume:                         volume_solute

                redox_CH4_SO4:
                    class: ReactionRedoxCH4_SO4

                    parameters:                 
                        R_CH4_SO4: 10.0 # (mol m-3) yr-1

                    variable_links:
                        volume:                         volume_solute
                        H2S_sms: SmIIaqtot_sms

                redox_H2_O2:
                    class: ReactionRedoxH2_O2

                    parameters:                 
                        R_H2_O2: 1e6 # (mol m-3)-1 yr-1 (1e6 M-1 yr-1 = 1e6*1e-3 (mol m-3)-1 yr-1, Dale (2015). NB: arbitrary, just need to scavenge H2 produced during pyrite formation)
                    variable_links:
                        volume:                         volume_solute

                redox_H2_SO4:
                    class: ReactionRedoxH2_SO4

                    parameters:                 
                        R_H2_SO4: 1e6 # (mol m-3)-1 yr-1 (1e6 M-1 yr-1 = 1e6*1e-3 (mol m-3)-1 yr-1, Dale (2015). NB: arbitrary, just need to scavenge H2 produced during pyrite formation)

                    variable_links:
                        volume:                         volume_solute
                        H2S_sms: SmIIaqtot_sms

                redox_FeII_O2:
                    class: ReactionRedoxFeII_O2

                    parameters:                     
                        R_FeII_O2: 5e5 # (mol m-3)-1 yr-1,  5e8 M-1 yr-1 = 5e8*1e-3 (mol m-3)-1 yr-1, Dale (2015)

                    variable_links:
                        volume:                         volume_solute
                        FeII_sms: FeIIaqtot_sms
                        FeIIIOx*: FeHR*


                redox_FeHR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 3.16 #  (mol m-3)^-0.5 yr-1, 100 M-0.5 yr-1        = 100*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:                         volume_solid
                        redox_FeIII_H2S*: redox_FeHR_H2S*
                        FeIIIOx*: FeHR*
                        FeII_sms: FeIIaqtot_sms
                        H2S_conc:  H2Stot_conc
                        H2S_sms: SmIIaqtot_sms

                redox_FeMR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 3.16e-3 #  (mol m-3)^-0.5 yr-1, 0.1 M-0.5 yr-1        = 0.1*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:                         volume_solid
                        redox_FeIII_H2S*: redox_FeMR_H2S*
                        FeIIIOx*: FeMR*
                        FeII_sms: FeIIaqtot_sms
                        H2S_conc:  H2Stot_conc
                        H2S_sms: SmIIaqtot_sms

                redox_FePR_H2S:
                    class: ReactionRedoxFeIII_H2S

                    parameters:
                        R_FeIII_H2S: 9.48e-6 #  (mol m-3)^-0.5 yr-1, 0.1 M-0.5 yr-1        = 3e-4*3.16e-2 (mol m-3)^-0.5 yr-1

                    variable_links:
                        volume:                         volume_solid
                        redox_FeIII_H2S*: redox_FePR_H2S*
                        FeIIIOx*: FePR*
                        FeII_sms: FeIIaqtot_sms
                        H2S_conc:  H2Stot_conc
                        H2S_sms: SmIIaqtot_sms

                redox_FeS_O2:
                    class: ReactionRedoxFeS_O2

                    parameters:
                        R_FeS_O2:  1e2    # (mol m-3)-1 yr-1,  1e5 M-1 yr-1 = 1e5*1e-3 

                    variable_links:
                        volume:                         volume_solid
                        FeS_*:    FeSm_*
                        FeII_sms: FeIIaqtot_sms

                redox_FeS2pyr_O2:
                    class: ReactionRedoxFeS2pyr_O2

                    parameters:
                        R_FeS2pyr_O2:  1.0    # (mol m-3)-1 yr-1,  1e3 M-1 yr-1 = 1e3*1e-3 

                    variable_links:
                        volume:                         volume_solid
                        FeII_sms: FeIIaqtot_sms

                FeSaq:
                    class: ReactionFeSaq

                FeSm:
                    class: ReactionFeSm

                    parameters:
                        rate_FeS_prec: 40.0 # mol m-3 yr-1  rate of FeS precipitation (van Cappellen & Wang value 1.5e-5 mol g yr-1 ~ 1.5-5 * 2.5e6 ~ 37.5 for rho = 2.5e6 g m-3)
                        rate_FeS_diss: 1e3  # yr-1  rate of FeS dissolution

                PyrH2S:
                    class: ReactionPyrH2S

                    parameters:
                        R_Pyr_H2S:  1e2  # (mol m-3) yr-1, 1e5 M yr-1 = 1e5*1e-3 (mol m-3) yr-1, Dale (2015)
                    variable_links:
                        volume:                         volume_solid
                        H2Ssp_conc:  H2Stot_conc  # Dale (2015) write this for total [H2S] = [H2S] + [HS-], not H2S species


        sedimentfloor:
            reactions:

        sedcrust: # dummy Domain to suppress error from fluxOceanBurial
            

